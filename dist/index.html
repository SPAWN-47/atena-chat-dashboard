<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AtenaChat - Dashboard CRM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes scaleIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes slideInRight { from { transform: translateX(100%); } to { transform: translateX(0); } }
        .c-fade-in { animation: fadeIn 0.3s ease-out; }
        .c-scale-in { animation: scaleIn 0.2s ease-out; }
        .c-slide-in-right { animation: slideInRight 0.3s ease-out; }
        .custom-scrollbar::-webkit-scrollbar { height: 8px; width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 4px; }
        * { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState } = React;

        // ===== ICONS =====
        const Icon = ({ type, size = 20, className = "" }) => {
            const icons = {
                grid: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="14" y="3" rx="1"/><rect width="7" height="7" x="14" y="14" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/></svg>,
                kanban: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M6 5v11"/><path d="M12 5v6"/><path d="M18 5v14"/></svg>,
                calendar: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M8 2v4"/><path d="M16 2v4"/><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M3 10h18"/></svg>,
                message: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>,
                users: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
                brain: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/><path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"/><path d="M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"/></svg>,
                book: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/></svg>,
                settings: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>,
                logout: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>,
                menu: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>,
                chevronLeft: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m15 18-6-6 6-6"/></svg>,
                bell: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></svg>,
                messageSquare: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>,
                trendingUp: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>,
                stethoscope: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3"/><path d="M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4"/><circle cx="20" cy="10" r="2"/></svg>,
                refresh: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>,
                upload: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>,
                download: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>,
                plus: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12h14"/><path d="M12 5v14"/></svg>,
                userPlus: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="19" x2="19" y1="8" y2="14"/><line x1="22" x2="16" y1="11" y2="11"/></svg>,
                moreVertical: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/></svg>,
                clock: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
                phone: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>,
                whatsapp: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m3 21 1.65-3.8a9 9 0 1 1 3.4 2.9L3 21"/><path d="M9 10a.5.5 0 0 0 1 0V9a.5.5 0 0 0-1 0v1a0 0 0 0 0 0 0"/><path d="M14 10a.5.5 0 0 0 1 0V9a.5.5 0 0 0-1 0v1a0 0 0 0 0 0 0"/></svg>,
                x: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
                dollarSign: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="12" x2="12" y1="2" y2="22"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
            };
            return icons[type] || icons.grid;
        };

        // ===== DASHBOARD COMPONENTS =====
        const DashboardStatCard = ({ title, value, icon, iconBgColor, textColor }) => (
            <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-100 flex items-start justify-between hover:shadow-md transition-shadow">
                <div>
                    <p className="text-slate-500 text-sm font-medium mb-1">{title}</p>
                    <h3 className="text-3xl font-bold text-slate-900">{value}</h3>
                </div>
                <div className={`p-3 rounded-lg ${iconBgColor}`}>
                    <Icon type={icon} size={24} className={textColor} />
                </div>
            </div>
        );

        const AreaChartComparison = () => (
            <div className="relative h-64 w-full mt-4">
                <div className="absolute left-0 top-0 h-full flex flex-col justify-between text-xs text-slate-400 py-1">
                    <span>24</span><span>18</span><span>12</span><span>6</span><span>0</span>
                </div>
                <div className="absolute left-8 right-0 top-0 h-full flex flex-col justify-between">
                    {[...Array(5)].map((_, i) => <div key={i} className="h-px bg-slate-100 w-full" />)}
                </div>
                <svg className="absolute left-8 right-0 top-0 w-[calc(100%-32px)] h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
                    <path d="M0,70 L14,60 L28,50 L42,30 L56,20 L70,30 L84,50 L100,65 V100 H0 Z" fill="rgba(99, 102, 241, 0.2)" stroke="rgb(99, 102, 241)" strokeWidth="1"/>
                    <path d="M0,80 L14,75 L28,65 L42,45 L56,35 L70,45 L84,60 L100,75 V100 H0 Z" fill="rgba(52, 211, 153, 0.2)" stroke="rgb(52, 211, 153)" strokeWidth="1"/>
                </svg>
                <div className="absolute bottom-0 left-8 right-0 h-4 flex justify-between items-center text-xs text-slate-400">
                    <span>Seg</span><span>Ter</span><span>Qua</span><span>Qui</span><span>Sex</span><span>Sﾃ｡b</span><span>Dom</span>
                </div>
            </div>
        );

        const Overview = () => (
            <div className="space-y-6 c-fade-in pb-20 md:pb-0">
                <div className="flex flex-col md:flex-row md:justify-between md:items-center gap-4">
                    <div>
                        <h1 className="text-3xl font-bold text-slate-900">Visﾃ｣o Geral</h1>
                        <p className="text-slate-500 mt-1">Anﾃ｡lise de desempenho da clﾃｭnica</p>
                    </div>
                    <div className="flex gap-2 bg-slate-100 p-1 rounded-lg self-start md:self-auto">
                        <button className="px-4 py-2 text-slate-600 rounded-md text-sm hover:bg-white hover:shadow-sm transition-all">Hoje</button>
                        <button className="px-4 py-2 bg-blue-600 text-white rounded-md text-sm shadow-sm transition-all">Semana</button>
                        <button className="px-4 py-2 text-slate-600 rounded-md text-sm hover:bg-white hover:shadow-sm transition-all">Mﾃｪs</button>
                    </div>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">
                    <DashboardStatCard title="Leads Totais" value="108" icon="messageSquare" iconBgColor="bg-blue-50" textColor="text-blue-600" />
                    <DashboardStatCard title="Novos Pacientes" value="42" icon="users" iconBgColor="bg-blue-50" textColor="text-blue-600" />
                    <DashboardStatCard title="Agendamentos IA" value="80" icon="stethoscope" iconBgColor="bg-green-50" textColor="text-green-600" />
                    <DashboardStatCard title="Taxa de Conversﾃ｣o" value="17%" icon="trendingUp" iconBgColor="bg-green-50" textColor="text-green-600" />
                    <DashboardStatCard title="Resgatados" value="15" icon="refresh" iconBgColor="bg-amber-50" textColor="text-amber-600" />
                </div>
                <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <div className="flex justify-between items-center mb-6">
                        <div>
                            <h3 className="font-bold text-slate-800">Novos Contatos vs Agendamentos</h3>
                            <p className="text-slate-500 text-sm">Comparativo semanal</p>
                        </div>
                    </div>
                    <AreaChartComparison />
                </div>
            </div>
        );

        // ===== CRM COMPONENTS =====
        const initialLeads = {
            novos: [
                { id: 1, name: 'Mariana Santos', source: 'INSTAGRAM', time: '10 min', procedure: '', value: '' },
                { id: 2, name: 'Joﾃ｣o Silva', source: 'SITE', time: '45 min', procedure: '', value: '' },
                { id: 3, name: 'Pedro Costa', source: 'INDICAﾃﾃグ', time: '2h', procedure: '', value: '' },
            ],
            conversa: [
                { id: 4, name: 'Ana Clara', source: 'WHATSAPP', time: 'Aguardando resposta', procedure: 'Clareamento', value: '' },
                { id: 5, name: 'Roberto Dias', source: 'INSTAGRAM', time: 'Em atendimento', procedure: '', value: '' },
            ],
            agendados: [
                { id: 6, name: 'Jﾃｺlia Mota', source: 'RETORNO', time: 'Amanhﾃ｣, 14:00', procedure: 'Limpeza', value: '300' },
                { id: 7, name: 'Marcos V.', source: 'SITE', time: 'Sexta, 09:00', procedure: 'Avaliaﾃｧﾃ｣o', value: '' },
            ],
            tratamento: [
                { id: 8, name: 'Felipe Neto', source: 'INDICAﾃﾃグ', time: 'Invisalign', procedure: 'Ortodontia', value: '12.000' },
            ],
        };

        const LeadCard = ({ lead, onOpenDetails, onDragStart, onDragEnd }) => {
            const sourceColors = {
                'INSTAGRAM': 'bg-pink-50 text-pink-700 border-pink-200',
                'WHATSAPP': 'bg-green-50 text-green-700 border-green-200',
                'SITE': 'bg-blue-50 text-blue-700 border-blue-200',
                'INDICAﾃﾃグ': 'bg-purple-50 text-purple-700 border-purple-200',
                'RETORNO': 'bg-amber-50 text-amber-700 border-amber-200',
            };

            const handleWhatsApp = (e) => {
                e.stopPropagation();
                const phone = lead.phone || '5511999999999';
                const message = lead.procedure
                    ? `Olﾃ｡ ${lead.name}! Vi que vocﾃｪ tem interesse em ${lead.procedure}. Como posso te ajudar?`
                    : `Olﾃ｡ ${lead.name}! Como posso te ajudar?`;
                const whatsappUrl = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            };

            const handlePhone = (e) => {
                e.stopPropagation();
                const phone = lead.phone || '11999999999';
                window.location.href = `tel:${phone}`;
            };

            return (
                <div
                    draggable
                    onDragStart={(e) => onDragStart(e, lead)}
                    onDragEnd={onDragEnd}
                    className="bg-white rounded-lg border border-slate-200 p-4 hover:shadow-md transition-shadow cursor-move hover:border-blue-300"
                >
                    <div className="flex items-start justify-between mb-3">
                        <span className={`text-xs font-bold px-2 py-1 rounded border ${sourceColors[lead.source]}`}>
                            {lead.source}
                        </span>
                        <button className="text-slate-400 hover:text-slate-600" onClick={(e) => { e.stopPropagation(); onOpenDetails(lead); }}>
                            <Icon type="moreVertical" size={16} />
                        </button>
                    </div>

                    <h3 className="font-bold text-slate-900 text-base mb-1">{lead.name}</h3>
                    <p className="text-xs text-slate-500 flex items-center gap-1 mb-3">
                        <Icon type="clock" size={12} />
                        {lead.time}
                    </p>

                    {(lead.procedure || lead.value) && (
                        <div className="bg-slate-50 rounded-lg p-2 mb-3 space-y-1">
                            {lead.procedure && (
                                <div className="text-xs text-slate-700 flex items-center gap-1">
                                    <Icon type="stethoscope" size={12} />
                                    {lead.procedure}
                                </div>
                            )}
                            {lead.value && (
                                <div className="text-xs font-bold text-emerald-600 flex items-center gap-1">
                                    <Icon type="dollarSign" size={12} />
                                    R$ {lead.value}
                                </div>
                            )}
                        </div>
                    )}

                    <div className="flex gap-2 pt-2 border-t border-slate-100">
                        <button
                            onClick={handleWhatsApp}
                            className="flex-1 bg-green-50 hover:bg-green-100 text-green-700 py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-1 transition-colors"
                        >
                            <Icon type="whatsapp" size={14} />
                            WhatsApp
                        </button>
                        <button
                            onClick={handlePhone}
                            className="bg-slate-50 hover:bg-slate-100 text-slate-600 p-2 rounded-lg transition-colors"
                        >
                            <Icon type="phone" size={14} />
                        </button>
                    </div>
                </div>
            );
        };

        const KanbanColumn = ({ columnId, title, count, color, leads, onOpenDetails, onDelete, isCustom, onDrop, onDragOver, onDragStart, onDragEnd, isDraggingOver }) => {
            const colorClasses = {
                blue: 'bg-blue-50 text-blue-700 border-blue-100',
                amber: 'bg-amber-50 text-amber-700 border-amber-100',
                green: 'bg-green-50 text-green-700 border-green-100',
                purple: 'bg-purple-50 text-purple-700 border-purple-100',
                slate: 'bg-slate-50 text-slate-700 border-slate-200',
            };

            return (
                <div
                    className="flex-shrink-0 w-80 group/column"
                    onDrop={(e) => onDrop(e, columnId)}
                    onDragOver={onDragOver}
                >
                    <div className={`flex items-center justify-between px-4 py-3 rounded-lg border mb-4 ${colorClasses[color] || colorClasses.slate}`}>
                        <div className="flex items-center gap-2">
                            <span className="font-bold text-sm">{title}</span>
                            <span className="bg-white px-2.5 py-0.5 rounded-full text-xs font-bold shadow-sm">{count}</span>
                        </div>
                        {isCustom && onDelete && (
                            <button
                                onClick={onDelete}
                                className="opacity-0 group-hover/column:opacity-100 text-red-500 hover:text-red-700 transition-opacity p-1"
                                title="Excluir coluna"
                            >
                                <Icon type="x" size={16} />
                            </button>
                        )}
                    </div>
                    <div className={`space-y-3 min-h-[200px] max-h-[calc(100vh-280px)] overflow-y-auto custom-scrollbar pr-2 p-2 rounded-lg transition-all ${isDraggingOver ? 'bg-blue-50 border-2 border-dashed border-blue-400' : ''}`}>
                        {leads.map(lead => (
                            <LeadCard
                                key={lead.id}
                                lead={lead}
                                onOpenDetails={onOpenDetails}
                                onDragStart={onDragStart}
                                onDragEnd={onDragEnd}
                            />
                        ))}
                        {leads.length === 0 && (
                            <div className="text-center py-8 text-slate-400 text-sm">
                                Arraste leads para cﾃ｡
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const LeadDetailsModal = ({ lead, onClose, onSave }) => {
            if (!lead) return null;

            const isNewLead = !lead.id;
            const getInitial = (name) => name ? name.charAt(0).toUpperCase() : '?';

            const [formData, setFormData] = React.useState({
                name: lead.name || '',
                source: lead.source || 'SITE',
                procedure: lead.procedure || '',
                value: lead.value || '',
                notes: lead.notes || '',
                date: lead.date || ''
            });

            const handleSave = () => {
                if (!formData.name.trim()) {
                    alert('Por favor, preencha o nome do paciente!');
                    return;
                }
                onSave({ ...lead, ...formData });
                onClose();
            };

            return (
                <div className="fixed inset-0 bg-black/30 z-50 flex items-center justify-end c-fade-in">
                    <div className="bg-white w-full max-w-lg h-full shadow-2xl c-slide-in-right overflow-y-auto">
                        <div className="sticky top-0 bg-white border-b border-slate-200 p-6 flex justify-between items-start">
                            <div>
                                <h2 className="text-xl font-bold text-slate-900">{isNewLead ? 'Novo Lead' : 'Detalhes do Lead'}</h2>
                                <p className="text-xs text-slate-500 mt-1">ID: {isNewLead ? 'Novo' : lead.id.toString().padStart(8, '0')}</p>
                            </div>
                            <button onClick={onClose} className="text-slate-400 hover:text-slate-600">
                                <Icon type="x" size={20} />
                            </button>
                        </div>

                        <div className="p-6 space-y-6">
                            <div className="bg-blue-50 border border-blue-100 rounded-xl p-4 flex items-center gap-4">
                                <div className="w-14 h-14 rounded-full bg-blue-200 flex items-center justify-center text-blue-700 font-bold text-xl">
                                    {getInitial(formData.name)}
                                </div>
                                <div className="flex-1">
                                    {isNewLead ? (
                                        <input
                                            type="text"
                                            placeholder="Nome do Paciente"
                                            value={formData.name}
                                            onChange={(e) => setFormData({...formData, name: e.target.value})}
                                            className="w-full bg-white border border-blue-200 rounded-lg px-3 py-2 font-bold text-lg text-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            autoFocus
                                        />
                                    ) : (
                                        <h3 className="font-bold text-lg text-slate-900">{formData.name}</h3>
                                    )}
                                    <p className="text-sm text-slate-600 mt-1">{formData.source} 窶｢ {lead.time || 'Agora'}</p>
                                </div>
                            </div>

                            {isNewLead && (
                                <div>
                                    <label className="block text-sm font-medium text-slate-700 mb-2">Origem</label>
                                    <select
                                        value={formData.source}
                                        onChange={(e) => setFormData({...formData, source: e.target.value})}
                                        className="w-full px-4 py-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white"
                                    >
                                        <option value="INSTAGRAM">Instagram</option>
                                        <option value="WHATSAPP">WhatsApp</option>
                                        <option value="SITE">Site</option>
                                        <option value="INDICAﾃﾃグ">Indicaﾃｧﾃ｣o</option>
                                        <option value="RETORNO">Retorno</option>
                                    </select>
                                </div>
                            )}

                            <div>
                                <label className="block text-sm font-medium text-slate-700 mb-2">Procedimento</label>
                                <div className="relative">
                                    <div className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400">
                                        <Icon type="stethoscope" size={18} />
                                    </div>
                                    <input
                                        type="text"
                                        placeholder="Ex: Implante..."
                                        value={formData.procedure}
                                        onChange={(e) => setFormData({...formData, procedure: e.target.value})}
                                        className="w-full pl-10 pr-4 py-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
                                    />
                                </div>
                            </div>

                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-sm font-medium text-slate-700 mb-2">Valor (R$)</label>
                                    <div className="relative">
                                        <div className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400">
                                            <Icon type="dollarSign" size={18} />
                                        </div>
                                        <input
                                            type="text"
                                            placeholder="0,00"
                                            value={formData.value}
                                            onChange={(e) => setFormData({...formData, value: e.target.value})}
                                            className="w-full pl-10 pr-4 py-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
                                        />
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-slate-700 mb-2">Agendamento</label>
                                    <div className="relative">
                                        <div className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400">
                                            <Icon type="calendar" size={18} />
                                        </div>
                                        <input
                                            type="date"
                                            value={formData.date}
                                            onChange={(e) => setFormData({...formData, date: e.target.value})}
                                            className="w-full pl-10 pr-4 py-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div>
                                <label className="block text-sm font-medium text-slate-700 mb-2">Anotaﾃｧﾃｵes</label>
                                <textarea
                                    rows={5}
                                    placeholder="Detalhes..."
                                    value={formData.notes}
                                    onChange={(e) => setFormData({...formData, notes: e.target.value})}
                                    className="w-full px-4 py-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none resize-none"
                                ></textarea>
                            </div>
                        </div>

                        <div className="sticky bottom-0 bg-slate-50 border-t border-slate-200 p-4 flex gap-3">
                            <button onClick={onClose} className="flex-1 px-6 py-3 border border-slate-300 text-slate-700 rounded-lg font-medium hover:bg-slate-100 transition-colors">
                                Cancelar
                            </button>
                            <button onClick={handleSave} className="flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 transition-colors">
                                {isNewLead ? 'Criar Lead' : 'Salvar'}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const CRM = () => {
            const [leads, setLeads] = useState(initialLeads);
            const [selectedLead, setSelectedLead] = useState(null);
            const [customColumns, setCustomColumns] = useState([]);
            const [draggedLead, setDraggedLead] = useState(null);
            const [draggedFromColumn, setDraggedFromColumn] = useState(null);
            const [dragOverColumn, setDragOverColumn] = useState(null);

            const defaultColumns = [
                { id: 'novos', title: 'Novos Leads', color: 'blue', isCustom: false },
                { id: 'conversa', title: 'Em Conversa', color: 'amber', isCustom: false },
                { id: 'agendados', title: 'Agendados', color: 'green', isCustom: false },
                { id: 'tratamento', title: 'Tratamento', color: 'purple', isCustom: false },
            ];

            const allColumns = [...defaultColumns, ...customColumns];

            // Drag and Drop handlers
            const handleDragStart = (e, lead) => {
                setDraggedLead(lead);
                // Encontrar de qual coluna o lead estﾃ｡ vindo
                const sourceColumn = allColumns.find(col =>
                    leads[col.id]?.some(l => l.id === lead.id)
                );
                setDraggedFromColumn(sourceColumn?.id);
                e.dataTransfer.effectAllowed = 'move';
            };

            const handleDragEnd = () => {
                setDraggedLead(null);
                setDraggedFromColumn(null);
                setDragOverColumn(null);
            };

            const handleDragOver = (e) => {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
            };

            const handleDrop = (e, targetColumnId) => {
                e.preventDefault();

                if (!draggedLead || !draggedFromColumn) return;

                // Se soltou na mesma coluna, nﾃ｣o faz nada
                if (draggedFromColumn === targetColumnId) {
                    handleDragEnd();
                    return;
                }

                // Remove o lead da coluna de origem
                const updatedLeads = { ...leads };
                updatedLeads[draggedFromColumn] = updatedLeads[draggedFromColumn].filter(
                    l => l.id !== draggedLead.id
                );

                // Adiciona o lead na coluna de destino
                if (!updatedLeads[targetColumnId]) {
                    updatedLeads[targetColumnId] = [];
                }
                updatedLeads[targetColumnId] = [...updatedLeads[targetColumnId], draggedLead];

                setLeads(updatedLeads);

                // Mostrar feedback
                const fromColumn = allColumns.find(c => c.id === draggedFromColumn);
                const toColumn = allColumns.find(c => c.id === targetColumnId);
                console.log(`笨 ${draggedLead.name} movido de "${fromColumn?.title}" para "${toColumn?.title}"`);

                handleDragEnd();
            };

            const handleCreateNewLead = () => {
                setSelectedLead({
                    name: '',
                    source: 'SITE',
                    time: 'Agora',
                    procedure: '',
                    value: '',
                    notes: '',
                    date: ''
                });
            };

            const handleSaveLead = (updatedLead) => {
                if (!updatedLead.id) {
                    const newLead = {
                        ...updatedLead,
                        id: Date.now(),
                        time: 'Agora'
                    };
                    setLeads(prev => ({
                        ...prev,
                        novos: [...prev.novos, newLead]
                    }));
                    alert('笨 Lead criado com sucesso!');
                } else {
                    const updateLeadsInColumn = (column) =>
                        column.map(lead => lead.id === updatedLead.id ? updatedLead : lead);

                    const updatedLeads = { ...leads };
                    Object.keys(updatedLeads).forEach(key => {
                        updatedLeads[key] = updateLeadsInColumn(updatedLeads[key]);
                    });
                    setLeads(updatedLeads);
                    alert('笨 Lead atualizado com sucesso!');
                }
            };

            const handleImport = () => {
                alert('踏 Funcionalidade de Importaﾃｧﾃ｣o em desenvolvimento.\n\nEm breve vocﾃｪ poderﾃ｡ importar leads via CSV/Excel!');
            };

            const handleExport = () => {
                const allLeadsArray = Object.values(leads).flat();
                const csvContent = `Nome,Origem,Procedimento,Valor,Status\n${allLeadsArray.map(l =>
                    `${l.name},${l.source},${l.procedure || ''},${l.value || ''},Ativo`
                ).join('\n')}`;

                const blob = new Blob([csvContent], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `leads-${new Date().toISOString().split('T')[0]}.csv`;
                a.click();
                alert('笨 Leads exportados com sucesso!');
            };

            const handleAddColumn = () => {
                const columnName = prompt('Digite o nome da nova coluna:');
                if (columnName && columnName.trim()) {
                    const columnId = `custom_${Date.now()}`;
                    const newColumn = {
                        id: columnId,
                        title: columnName.trim(),
                        color: 'slate',
                        isCustom: true
                    };
                    setCustomColumns(prev => [...prev, newColumn]);
                    setLeads(prev => ({ ...prev, [columnId]: [] }));
                    alert(`笨 Coluna "${columnName}" criada com sucesso!`);
                }
            };

            const handleDeleteColumn = (columnId) => {
                const column = customColumns.find(col => col.id === columnId);
                if (column && confirm(`Tem certeza que deseja excluir a coluna "${column.title}"?\n\nTodos os leads desta coluna serﾃ｣o perdidos!`)) {
                    setCustomColumns(prev => prev.filter(col => col.id !== columnId));
                    const newLeads = { ...leads };
                    delete newLeads[columnId];
                    setLeads(newLeads);
                    alert('笨 Coluna excluﾃｭda com sucesso!');
                }
            };

            return (
                <div className="c-fade-in pb-20 md:pb-0">
                    <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                        <div>
                            <h1 className="text-3xl font-bold text-slate-900">CRM - Kanban de Vendas</h1>
                            <p className="text-slate-600 mt-1">Gerencie seu funil de pacientes de forma visual.</p>
                        </div>

                        <div className="flex gap-2 flex-wrap">
                            <button onClick={handleImport} className="px-4 py-2 bg-white border border-slate-300 text-slate-700 rounded-lg font-medium hover:bg-slate-50 transition-colors flex items-center gap-2 text-sm">
                                <Icon type="upload" size={16} />
                                Importar
                            </button>
                            <button onClick={handleExport} className="px-4 py-2 bg-white border border-slate-300 text-slate-700 rounded-lg font-medium hover:bg-slate-50 transition-colors flex items-center gap-2 text-sm">
                                <Icon type="download" size={16} />
                                Exportar
                            </button>
                            <button onClick={handleAddColumn} className="px-4 py-2 bg-white border border-slate-300 text-slate-700 rounded-lg font-medium hover:bg-slate-50 transition-colors flex items-center gap-2 text-sm">
                                <Icon type="plus" size={16} />
                                Coluna
                            </button>
                            <button onClick={handleCreateNewLead} className="px-4 py-2 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 transition-colors flex items-center gap-2 shadow-sm text-sm">
                                <Icon type="userPlus" size={16} />
                                Novo Lead
                            </button>
                        </div>
                    </div>

                    <div className="flex gap-6 overflow-x-auto pb-4 custom-scrollbar">
                        {allColumns.map(column => (
                            <KanbanColumn
                                key={column.id}
                                columnId={column.id}
                                title={column.title}
                                count={leads[column.id]?.length || 0}
                                color={column.color}
                                leads={leads[column.id] || []}
                                onOpenDetails={setSelectedLead}
                                onDelete={column.isCustom ? () => handleDeleteColumn(column.id) : null}
                                isCustom={column.isCustom}
                                onDrop={handleDrop}
                                onDragOver={handleDragOver}
                                onDragStart={handleDragStart}
                                onDragEnd={handleDragEnd}
                                isDraggingOver={dragOverColumn === column.id}
                            />
                        ))}
                    </div>

                    <LeadDetailsModal lead={selectedLead} onClose={() => setSelectedLead(null)} onSave={handleSaveLead} />
                </div>
            );
        };

        // ===== AGENDA COMPONENTS =====
        const HORARIOS = ['08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00'];
        const DIAS_SEMANA = ['SEG', 'TER', 'QUA', 'QUI', 'SEX', 'SAB'];

        const AgendamentoModal = ({ agendamento, onClose, onSave }) => {
            const [formData, setFormData] = React.useState({
                paciente: agendamento?.paciente || '',
                procedimento: agendamento?.procedimento || '',
                data: agendamento?.data || '',
                hora: agendamento?.hora || '',
                status: agendamento?.status || 'pendente'
            });

            const handleSave = () => {
                if (!formData.paciente.trim()) {
                    alert('Por favor, preencha o nome do paciente!');
                    return;
                }
                onSave({ ...agendamento, ...formData });
                onClose();
            };

            return (
                <div className="fixed inset-0 bg-black/30 z-50 flex items-center justify-center c-fade-in">
                    <div className="bg-white w-full max-w-md rounded-xl shadow-2xl c-scale-in">
                        <div className="p-6 border-b border-slate-200 flex justify-between items-center">
                            <h2 className="text-xl font-bold text-slate-900">
                                {agendamento?.id ? 'Editar Agendamento' : 'Novo Agendamento'}
                            </h2>
                            <button onClick={onClose} className="text-slate-400 hover:text-slate-600">
                                <Icon type="x" size={20} />
                            </button>
                        </div>

                        <div className="p-6 space-y-4">
                            <div>
                                <label className="block text-sm font-medium text-slate-700 mb-2">Paciente</label>
                                <input
                                    type="text"
                                    value={formData.paciente}
                                    onChange={(e) => setFormData({...formData, paciente: e.target.value})}
                                    placeholder="Nome do paciente"
                                    className="w-full px-4 py-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                    autoFocus
                                />
                            </div>

                            <div>
                                <label className="block text-sm font-medium text-slate-700 mb-2">Procedimento</label>
                                <input
                                    type="text"
                                    value={formData.procedimento}
                                    onChange={(e) => setFormData({...formData, procedimento: e.target.value})}
                                    placeholder="Ex: Limpeza, Clareamento..."
                                    className="w-full px-4 py-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                />
                            </div>

                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-sm font-medium text-slate-700 mb-2">Data</label>
                                    <input
                                        type="date"
                                        value={formData.data}
                                        onChange={(e) => setFormData({...formData, data: e.target.value})}
                                        className="w-full px-4 py-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-slate-700 mb-2">Horﾃ｡rio</label>
                                    <select
                                        value={formData.hora}
                                        onChange={(e) => setFormData({...formData, hora: e.target.value})}
                                        className="w-full px-4 py-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white"
                                    >
                                        <option value="">Selecione</option>
                                        {HORARIOS.map(h => <option key={h} value={h}>{h}</option>)}
                                    </select>
                                </div>
                            </div>

                            <div>
                                <label className="block text-sm font-medium text-slate-700 mb-2">Status</label>
                                <select
                                    value={formData.status}
                                    onChange={(e) => setFormData({...formData, status: e.target.value})}
                                    className="w-full px-4 py-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white"
                                >
                                    <option value="pendente">Pendente</option>
                                    <option value="confirmado">Confirmado</option>
                                    <option value="bloqueio">Bloqueio</option>
                                </select>
                            </div>
                        </div>

                        <div className="p-4 bg-slate-50 border-t border-slate-200 flex gap-3">
                            <button onClick={onClose} className="flex-1 px-6 py-3 border border-slate-300 text-slate-700 rounded-lg font-medium hover:bg-slate-100">
                                Cancelar
                            </button>
                            <button onClick={handleSave} className="flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700">
                                Salvar
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const Agenda = () => {
            const [agendamentos, setAgendamentos] = useState([
                { id: 1, paciente: 'Ana Clara', procedimento: 'Avaliaﾃｧﾃ｣o', data: '2025-11-18', hora: '09:00', status: 'confirmado' },
                { id: 2, paciente: 'Mariana C.', procedimento: 'Limpeza', data: '2025-11-19', hora: '10:00', status: 'confirmado' },
                { id: 3, paciente: 'Pedro H.', procedimento: 'Manutenﾃｧﾃ｣o', data: '2025-11-17', hora: '14:00', status: 'pendente' },
            ]);
            const [selectedAgendamento, setSelectedAgendamento] = useState(null);
            const [weekStart, setWeekStart] = useState(new Date());

            const getWeekDays = () => {
                const days = [];
                const start = new Date(weekStart);
                start.setDate(start.getDate() - start.getDay() + 1); // Segunda-feira

                for (let i = 0; i < 6; i++) {
                    const day = new Date(start);
                    day.setDate(start.getDate() + i);
                    days.push(day);
                }
                return days;
            };

            const weekDays = getWeekDays();

            const formatDate = (date) => {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            };

            const getAgendamentoForSlot = (date, hora) => {
                const dateStr = formatDate(date);
                return agendamentos.find(a => a.data === dateStr && a.hora === hora);
            };

            const handlePreviousWeek = () => {
                const newDate = new Date(weekStart);
                newDate.setDate(newDate.getDate() - 7);
                setWeekStart(newDate);
            };

            const handleNextWeek = () => {
                const newDate = new Date(weekStart);
                newDate.setDate(newDate.getDate() + 7);
                setWeekStart(newDate);
            };

            const handleSlotClick = (date, hora, agendamento) => {
                if (agendamento) {
                    setSelectedAgendamento(agendamento);
                } else {
                    setSelectedAgendamento({
                        data: formatDate(date),
                        hora: hora,
                        status: 'pendente'
                    });
                }
            };

            const handleSaveAgendamento = (updatedAgendamento) => {
                if (updatedAgendamento.id) {
                    setAgendamentos(prev =>
                        prev.map(a => a.id === updatedAgendamento.id ? updatedAgendamento : a)
                    );
                    alert('笨 Agendamento atualizado!');
                } else {
                    const newAgendamento = { ...updatedAgendamento, id: Date.now() };
                    setAgendamentos(prev => [...prev, newAgendamento]);
                    alert('笨 Agendamento criado!');
                }
            };

            const handleConfirmar = (agendamento) => {
                setAgendamentos(prev =>
                    prev.map(a =>
                        a.id === agendamento.id ? { ...a, status: 'confirmado' } : a
                    )
                );
                alert(`笨 Agendamento de ${agendamento.paciente} confirmado!`);
            };

            const getStatusColor = (status) => {
                switch(status) {
                    case 'confirmado': return 'bg-green-100 border-green-300 text-green-800';
                    case 'pendente': return 'bg-amber-100 border-amber-300 text-amber-800';
                    case 'bloqueio': return 'bg-blue-100 border-blue-300 text-blue-800';
                    default: return 'bg-slate-100 border-slate-300';
                }
            };

            const formatWeekRange = () => {
                const start = weekDays[0];
                const end = weekDays[weekDays.length - 1];
                const monthNames = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
                return `${start.getDate()} - ${end.getDate()} ${monthNames[end.getMonth()]} ${end.getFullYear()}`;
            };

            return (
                <div className="c-fade-in pb-20 md:pb-0">
                    <div className="flex justify-between items-center mb-6">
                        <div>
                            <h1 className="text-3xl font-bold text-slate-900">Agenda</h1>
                            <p className="text-slate-600 mt-1">Visualize e gerencie seus agendamentos.</p>
                        </div>
                        <div className="flex items-center gap-3">
                            <button onClick={handlePreviousWeek} className="p-2 hover:bg-slate-100 rounded-lg">
                                <Icon type="chevronLeft" size={20} />
                            </button>
                            <span className="font-bold text-slate-900 min-w-[200px] text-center">{formatWeekRange()}</span>
                            <button onClick={handleNextWeek} className="p-2 hover:bg-slate-100 rounded-lg">
                                <Icon type="chevronLeft" size={20} className="rotate-180" />
                            </button>
                        </div>
                    </div>

                    <div className="bg-white rounded-xl border border-slate-200 overflow-x-auto">
                        <table className="w-full">
                            <thead className="bg-slate-50 border-b border-slate-200">
                                <tr>
                                    <th className="p-4 text-left text-xs font-bold text-slate-600 w-24">HORA</th>
                                    {weekDays.map((day, i) => {
                                        const isToday = formatDate(day) === formatDate(new Date());
                                        return (
                                            <th key={i} className={`p-4 text-center ${isToday ? 'bg-blue-50' : ''}`}>
                                                <div className="text-xs font-bold text-slate-600">{DIAS_SEMANA[i]}</div>
                                                <div className={`text-2xl font-bold mt-1 ${isToday ? 'text-blue-600' : 'text-slate-900'}`}>
                                                    {day.getDate()}
                                                </div>
                                            </th>
                                        );
                                    })}
                                </tr>
                            </thead>
                            <tbody>
                                {HORARIOS.map((hora) => (
                                    <tr key={hora} className="border-b border-slate-100">
                                        <td className="p-4 text-sm text-slate-500 font-medium bg-slate-50">{hora}</td>
                                        {weekDays.map((day, i) => {
                                            const agendamento = getAgendamentoForSlot(day, hora);
                                            return (
                                                <td
                                                    key={i}
                                                    onClick={() => handleSlotClick(day, hora, agendamento)}
                                                    className="p-2 cursor-pointer hover:bg-slate-50 transition-colors"
                                                >
                                                    {agendamento ? (
                                                        <div className={`p-3 rounded-lg border-2 ${getStatusColor(agendamento.status)}`}>
                                                            <div className="font-bold text-sm mb-1">{agendamento.paciente}</div>
                                                            <div className="text-xs mb-2">{agendamento.procedimento}</div>
                                                            {agendamento.status === 'pendente' && (
                                                                <button
                                                                    onClick={(e) => { e.stopPropagation(); handleConfirmar(agendamento); }}
                                                                    className="text-xs font-bold text-amber-700 hover:text-amber-900"
                                                                >
                                                                    Confirmar?
                                                                </button>
                                                            )}
                                                        </div>
                                                    ) : null}
                                                </td>
                                            );
                                        })}
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>

                    {selectedAgendamento && (
                        <AgendamentoModal
                            agendamento={selectedAgendamento}
                            onClose={() => setSelectedAgendamento(null)}
                            onSave={handleSaveAgendamento}
                        />
                    )}
                </div>
            );
        };

        // ===== PLACEHOLDER PAGES =====
        const PlaceholderPage = ({ title, icon, color }) => (
            <div className="c-fade-in pb-20 md:pb-0">
                <h1 className="text-3xl font-bold text-slate-900 mb-6">{title}</h1>
                <div className="bg-white p-12 rounded-xl text-center shadow-sm border border-slate-100">
                    <Icon type={icon} size={64} className={`${color} mx-auto mb-4`} />
                    <p className="text-slate-600 text-lg">Funcionalidade em desenvolvimento...</p>
                    <p className="text-slate-400 text-sm mt-2">Em breve disponﾃｭvel</p>
                </div>
            </div>
        );

        // ===== MENU ITEMS =====
        const menuItems = [
            { id: 'dashboard', label: 'Dashboard', icon: 'grid', component: Overview },
            { id: 'crm', label: 'CRM', icon: 'kanban', component: CRM },
            { id: 'agenda', label: 'Agenda', icon: 'calendar', component: Agenda },
            { id: 'scripts', label: 'Scripts', icon: 'message', component: () => <PlaceholderPage title="Scripts" icon="message" color="text-purple-600" /> },
            { id: 'pacientes', label: 'Pacientes', icon: 'users', component: () => <PlaceholderPage title="Pacientes" icon="users" color="text-indigo-600" /> },
            { id: 'ai-config', label: 'Base de Conhecimento', icon: 'brain', component: () => <PlaceholderPage title="Base de Conhecimento" icon="brain" color="text-pink-600" /> },
            { id: 'help', label: 'Ajuda & Tutoriais', icon: 'book', component: () => <PlaceholderPage title="Ajuda & Tutoriais" icon="book" color="text-amber-600" /> },
            { id: 'my-clinic', label: 'Minha Clﾃｭnica', icon: 'settings', component: () => <PlaceholderPage title="Minha Clﾃｭnica" icon="settings" color="text-slate-600" /> },
        ];

        // ===== MAIN DASHBOARD LAYOUT =====
        function DashboardLayout() {
            const [isSidebarOpen, setIsSidebarOpen] = useState(true);
            const [activeItem, setActiveItem] = useState('dashboard');

            const ActiveComponent = menuItems.find(item => item.id === activeItem)?.component || Overview;

            return (
                <div className="flex h-screen bg-slate-50 font-sans overflow-hidden">
                    {isSidebarOpen && <div className="fixed inset-0 bg-black/20 z-20 md:hidden" onClick={() => setIsSidebarOpen(false)}/>}

                    <aside className={`bg-white border-r border-slate-200 shadow-xl md:shadow-none fixed md:relative z-30 h-full flex flex-col transition-all duration-300 ${isSidebarOpen ? 'w-64' : 'w-0 md:w-20 overflow-hidden'}`}>
                        <div className="h-20 flex items-center justify-between px-4 border-b border-slate-100">
                            <div className="flex items-center gap-3">
                                <div className="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold">A</div>
                                {isSidebarOpen && <span className="font-bold text-slate-900">AtenaChat</span>}
                            </div>
                            <button onClick={() => setIsSidebarOpen(!isSidebarOpen)} className="hidden md:block text-slate-400 hover:text-slate-600">
                                <Icon type="chevronLeft" size={20} />
                            </button>
                        </div>

                        <nav className="flex-1 py-6 px-3 space-y-1 overflow-y-auto custom-scrollbar">
                            {menuItems.map(item => (
                                <button
                                    key={item.id}
                                    onClick={() => setActiveItem(item.id)}
                                    className={`flex items-center w-full p-3 rounded-xl text-sm font-medium transition-all ${activeItem === item.id ? 'bg-blue-50 text-blue-700' : 'text-slate-500 hover:bg-slate-50 hover:text-slate-800'}`}
                                    title={!isSidebarOpen ? item.label : ''}
                                >
                                    <Icon type={item.icon} size={22} />
                                    {isSidebarOpen && <span className="ml-3">{item.label}</span>}
                                </button>
                            ))}
                        </nav>

                        <div className="p-4 border-t border-slate-100 bg-slate-50/50 mt-auto">
                            {isSidebarOpen && (
                                <div className="flex items-center gap-3 mb-3">
                                    <div className="w-9 h-9 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white font-bold text-sm">
                                        DS
                                    </div>
                                    <div className="overflow-hidden">
                                        <div className="font-bold text-sm text-slate-800">Dr. Silva</div>
                                        <div className="text-xs text-slate-500 flex items-center gap-1">
                                            <span className="w-2 h-2 bg-emerald-500 rounded-full"></span> Online
                                        </div>
                                    </div>
                                </div>
                            )}
                            <button
                                className={`flex items-center w-full p-2 rounded-lg text-sm font-medium transition-colors ${isSidebarOpen ? 'text-rose-600 hover:bg-rose-50 justify-start' : 'text-slate-400 hover:bg-slate-100 hover:text-rose-500 justify-center'}`}
                                title="Sair"
                            >
                                <Icon type="logout" size={20} />
                                {isSidebarOpen && <span className="ml-2">Sair</span>}
                            </button>
                        </div>
                    </aside>

                    <div className="flex-1 flex flex-col h-full overflow-hidden relative">
                        <header className="md:hidden h-16 bg-white border-b border-slate-200 flex items-center px-4 justify-between">
                            <div className="flex items-center gap-3">
                                <button onClick={() => setIsSidebarOpen(true)}>
                                    <Icon type="menu" size={24} className="text-slate-600"/>
                                </button>
                                <span className="font-bold text-slate-900">AtenaChat</span>
                            </div>
                            <div className="flex items-center gap-3">
                                <Icon type="bell" size={20} className="text-slate-500"/>
                                <div className="w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white font-bold text-xs">
                                    DS
                                </div>
                            </div>
                        </header>

                        <main className="flex-1 overflow-y-auto bg-slate-50 p-4 md:p-8 scroll-smooth">
                            <div className="max-w-7xl mx-auto h-full">
                                <ActiveComponent />
                            </div>
                        </main>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<DashboardLayout />);
    </script>
</body>
</html>
